@php

    $transactions = [
        [
            'date' => '12-11-2024',
            'description' => 'ATM Withdrawal',
            'cheque_no' => null,
            'withdrawal' => null,
            'deposit' => 3186.6,
            'balance_bdt' => 4186.6,
        ],
        [
            'date' => '17-11-2024',
            'description' => 'CITYTOUCH/NPSB',
            'cheque_no' => null,
            'withdrawal' => null,
            'deposit' => 14849.3,
            'balance_bdt' => 17003.52,
        ],
        [
            'date' => '17-11-2024',
            'description' => 'CITY TOUCH/EFTN',
            'cheque_no' => null,
            'withdrawal' => 3085.86,
            'deposit' => null,
            'balance_bdt' => 590.83,
        ],
        [
            'date' => '25-11-2024',
            'description' => 'ATM Withdrawal',
            'cheque_no' => null,
            'withdrawal' => 2032.38,
            'deposit' => null,
            'balance_bdt' => 2154.22,
        ],
        [
            'date' => '26-11-2024',
            'description' => 'CITY TOUCH/EFTN',
            'cheque_no' => null,
            'withdrawal' => 524.63,
            'deposit' => null,
            'balance_bdt' => 66.2,
        ],
        [
            'date' => '28-11-2024',
            'description' => 'bKash_Inc//011424342854',
            'cheque_no' => null,
            'withdrawal' => 6081.9,
            'deposit' => null,
            'balance_bdt' => 10921.62,
        ],
        [
            'date' => '28-11-2024',
            'description' => 'CITY TOUCH/EFTN',
            'cheque_no' => null,
            'withdrawal' => 7244.93,
            'deposit' => null,
            'balance_bdt' => 3676.69,
        ],
        [
            'date' => '05-12-2024',
            'description' => 'Online Purchase',
            'cheque_no' => null,
            'withdrawal' => 209.07,
            'deposit' => null,
            'balance_bdt' => 9697.24,
        ],
        [
            'date' => '08-12-2024',
            'description' => 'Salary Credit',
            'cheque_no' => null,
            'withdrawal' => 3768.97,
            'deposit' => null,
            'balance_bdt' => 5928.27,
        ],
        [
            'date' => '08-12-2024',
            'description' => 'bKash_Inc//011424342854',
            'cheque_no' => null,
            'withdrawal' => 4639.94,
            'deposit' => null,
            'balance_bdt' => 21713.48,
        ],
        [
            'date' => '13-12-2024',
            'description' => 'CITYTOUCH/NPSB',
            'cheque_no' => null,
            'withdrawal' => null,
            'deposit' => 9484.27,
            'balance_bdt' => 31197.75,
        ],
        [
            'date' => '17-12-2024',
            'description' => 'bKash_Inc//011424342854',
            'cheque_no' => null,
            'withdrawal' => null,
            'deposit' => 6135.32,
            'balance_bdt' => 26353.42,
        ],
        [
            'date' => '22-12-2024',
            'description' => 'Salary Credit',
            'cheque_no' => null,
            'withdrawal' => null,
            'deposit' => 9840.11,
            'balance_bdt' => 9906.31,
        ],
        [
            'date' => '22-12-2024',
            'description' => 'Utility Bill Payment',
            'cheque_no' => null,
            'withdrawal' => null,
            'deposit' => 14289.83,
            'balance_bdt' => 20218.1,
        ],
        [
            'date' => '03-01-2025',
            'description' => 'POS Purchase',
            'cheque_no' => null,
            'withdrawal' => 2386.53,
            'deposit' => null,
            'balance_bdt' => 1278.3,
        ],
        [
            'date' => '04-01-2025',
            'description' => 'CT/FT-CBLTA',
            'cheque_no' => null,
            'withdrawal' => 7375.18,
            'deposit' => null,
            'balance_bdt' => 3664.83,
        ],
        [
            'date' => '07-01-2025',
            'description' => 'bKash_Inc//011424342854',
            'cheque_no' => null,
            'withdrawal' => 5000.0,
            'deposit' => null,
            'balance_bdt' => 665.11,
        ],
        [
            'date' => '09-01-2025',
            'description' => 'bKash_Inc//011424342854',
            'cheque_no' => null,
            'withdrawal' => 8797.49,
            'deposit' => null,
            'balance_bdt' => 22400.26,
        ],
        [
            'date' => '16-01-2025',
            'description' => 'CT/FT-CBLTA',
            'cheque_no' => null,
            'withdrawal' => 2617.48,
            'deposit' => null,
            'balance_bdt' => 391.79,
        ],
        [
            'date' => '17-01-2025',
            'description' => 'CITYTOUCH/NPSB',
            'cheque_no' => null,
            'withdrawal' => 1701.91,
            'deposit' => null,
            'balance_bdt' => 11040.01,
        ],
        [
            'date' => '19-01-2025',
            'description' => 'CITYTOUCH/NPSB',
            'cheque_no' => null,
            'withdrawal' => null,
            'deposit' => 50000.0,
            'balance_bdt' => 3009.27,
        ],
        [
            'date' => '20-01-2025',
            'description' => 'ATM Withdrawal',
            'cheque_no' => null,
            'withdrawal' => 230.65,
            'deposit' => null,
            'balance_bdt' => 161.14,
        ],
        [
            'date' => '23-01-2025',
            'description' => 'Online Purchase',
            'cheque_no' => null,
            'withdrawal' => 9658.34,
            'deposit' => null,
            'balance_bdt' => 12741.92,
        ],
        [
            'date' => '27-01-2025',
            'description' => 'ATM Withdrawal',
            'cheque_no' => null,
            'withdrawal' => 566.24,
            'deposit' => null,
            'balance_bdt' => 98.87,
        ],
        [
            'date' => '02-02-2025',
            'description' => 'CITYTOUCH/NPSB',
            'cheque_no' => null,
            'withdrawal' => null,
            'deposit' => 50000.0,
            'balance_bdt' => 16405.87,
        ],
        [
            'date' => '05-02-2025',
            'description' => 'CARD FEE',
            'cheque_no' => null,
            'withdrawal' => 10529.87,
            'deposit' => null,
            'balance_bdt' => 21503.37,
        ],
        [
            'date' => '06-02-2025',
            'description' => 'CITYTOUCH/NPSB',
            'cheque_no' => null,
            'withdrawal' => 8624.44,
            'deposit' => null,
            'balance_bdt' => 12878.93,
        ],
        [
            'date' => '07-02-2025',
            'description' => 'CT/FT-CBLTA',
            'cheque_no' => null,
            'withdrawal' => 969.95,
            'deposit' => null,
            'balance_bdt' => 217.29,
        ],
        [
            'date' => '15-02-2025',
            'description' => 'Utility Bill Payment',
            'cheque_no' => null,
            'withdrawal' => 4259.64,
            'deposit' => null,
            'balance_bdt' => 32033.24,
        ],
        [
            'date' => '22-02-2025',
            'description' => 'ATM Withdrawal',
            'cheque_no' => null,
            'withdrawal' => null,
            'deposit' => 19887.01,
            'balance_bdt' => 36292.88,
        ],
        [
            'date' => '25-02-2025',
            'description' => 'CITY TOUCH/EFTN',
            'cheque_no' => null,
            'withdrawal' => 11691.69,
            'deposit' => null,
            'balance_bdt' => 1187.24,
        ],
        [
            'date' => '03-03-2025',
            'description' => 'Online Purchase',
            'cheque_no' => null,
            'withdrawal' => 7615.4,
            'deposit' => null,
            'balance_bdt' => 4361.64,
        ],
        [
            'date' => '07-03-2025',
            'description' => 'POS Purchase',
            'cheque_no' => null,
            'withdrawal' => 10853.1,
            'deposit' => null,
            'balance_bdt' => 3771.2,
        ],
        [
            'date' => '10-03-2025',
            'description' => 'Online Purchase',
            'cheque_no' => null,
            'withdrawal' => 2748.32,
            'deposit' => null,
            'balance_bdt' => 1022.88,
        ],
        [
            'date' => '12-03-2025',
            'description' => 'CITYTOUCH/NPSB',
            'cheque_no' => null,
            'withdrawal' => 158.32,
            'deposit' => null,
            'balance_bdt' => 58.97,
        ],
        [
            'date' => '18-03-2025',
            'description' => 'bKash_Inc//011424342854',
            'cheque_no' => null,
            'withdrawal' => null,
            'deposit' => 14686.88,
            'balance_bdt' => 14624.3,
        ],
        [
            'date' => '20-03-2025',
            'description' => 'CARD FEE',
            'cheque_no' => null,
            'withdrawal' => null,
            'deposit' => 18604.36,
            'balance_bdt' => 19627.24,
        ],
        [
            'date' => '25-03-2025',
            'description' => 'CARD FEE',
            'cheque_no' => null,
            'withdrawal' => 50.23,
            'deposit' => null,
            'balance_bdt' => -62.58,
        ],
        [
            'date' => '26-03-2025',
            'description' => 'SMS*RENEW*2024*BDT*2803100212',
            'cheque_no' => null,
            'withdrawal' => 71.32,
            'deposit' => null,
            'balance_bdt' => -12.35,
        ],
        [
            'date' => '28-03-2025',
            'description' => 'CITYTOUCH/NPSB',
            'cheque_no' => null,
            'withdrawal' => 7650.2,
            'deposit' => null,
            'balance_bdt' => 11977.04,
        ],
        [
            'date' => '01-04-2025',
            'description' => 'Online Purchase',
            'cheque_no' => null,
            'withdrawal' => 509.93,
            'deposit' => null,
            'balance_bdt' => 116.74,
        ],
        [
            'date' => '04-04-2025',
            'description' => 'Utility Bill Payment',
            'cheque_no' => null,
            'withdrawal' => 7356.37,
            'deposit' => null,
            'balance_bdt' => 4909.25,
        ],
        [
            'date' => '11-04-2025',
            'description' => 'ATM Withdrawal',
            'cheque_no' => null,
            'withdrawal' => 4296.76,
            'deposit' => null,
            'balance_bdt' => 626.67,
        ],
        [
            'date' => '13-04-2025',
            'description' => 'CARD FEE',
            'cheque_no' => null,
            'withdrawal' => null,
            'deposit' => 7903.98,
            'balance_bdt' => 12265.62,
        ],
        [
            'date' => '13-04-2025',
            'description' => 'CITYTOUCH/NPSB',
            'cheque_no' => null,
            'withdrawal' => 596.64,
            'deposit' => null,
            'balance_bdt' => 2471.79,
        ],
        [
            'date' => '15-04-2025',
            'description' => 'CT/FT-CBLTA',
            'cheque_no' => null,
            'withdrawal' => 1567.11,
            'deposit' => null,
            'balance_bdt' => 3068.43,
        ],
        [
            'date' => '17-04-2025',
            'description' => 'SMS*RENEW*2024*BDT*2803100212',
            'cheque_no' => null,
            'withdrawal' => 710.39,
            'deposit' => null,
            'balance_bdt' => 1761.4,
        ],
        [
            'date' => '18-04-2025',
            'description' => 'ATM Withdrawal',
            'cheque_no' => null,
            'withdrawal' => null,
            'deposit' => 795.14,
            'balance_bdt' => 4635.54,
        ],
        [
            'date' => '24-04-2025',
            'description' => 'bKash_Inc//011424342854',
            'cheque_no' => null,
            'withdrawal' => null,
            'deposit' => 3162.03,
            'balance_bdt' => 4923.43,
        ],
        [
            'date' => '28-04-2025',
            'description' => 'CITY TOUCH/EFTN',
            'cheque_no' => null,
            'withdrawal' => 1068.85,
            'deposit' => null,
            'balance_bdt' => 3840.4,
        ],
    ];

@endphp

@php 
    $bank_acc = generate_bank_account();
@endphp

<!doctype html>
<html>

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{{$title}}</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

    <style>
        body {
            font-size: 10pt;
            line-height: 1rem;
            padding: 0 50px 50px 50px;
        }

        .header {
            margin-top: 50px;
        }

        .divider {
            border: 2px solid black;
            margin: 2px 0;
        }

        #tableAccount {
            margin-left: auto;
            margin-right: 0;
            font-size: 13px;
            border-spacing: 0;
            padding: 0;
            font-family: 'Courier New', monospace;
        }

        #tableAccount tr {
            padding: 0;
            margin: 0;
        }

        #tableAccount td {
            padding: 0 2px;
            margin: 0;
        }

        #transactionTable {
            margin-top: 20px;
            width: 100%;
        }

        #transactionTable tbody:before {
            content: "@";
            display: block;
            line-height: 10px;
            text-indent: -99999px;
        }

        #transactionTable th {
            border: 0.5px solid;
            padding: 5px;
        }

        #transactionTable td {
            font-family: 'Courier New', monospace;
            padding: 3px;
        }

        @media print {
            .pagebreak {
                page-break-before: always;
            }

            /* page-break-after works, as well */
        }
    </style>
</head>

<body>

    @include('partials.bank_header')

    <div class="content">
        <div class="row">
            <table id="transactionTable">
                <thead>
                    <tr>
                        <th>DATE</th>
                        <th>DESCRIPTION</th>
                        <th>CHQ.NO. </th>
                        <th class="text-end">WITHDRAWAL</th>
                        <th class="text-end">DEPOSIT</th>
                        <th class="text-end">BALANCE [BDT]</th>
                    </tr>
                </thead>

                <tbody>
                    @php
                        $opening = rand(20000, 30000);
                        $deposit = 0;
                        $withdrawal = 0;
                    @endphp

                    @foreach ($transactions as $key => $transaction)
                        @php
                            $deposit += $transaction['deposit'] ?? 0;
                            $withdrawal += $transaction['withdrawal'] ?? 0;
                        @endphp

                        @if ($key > 33)
                            @break
                        @else
                            <tr>
                                <td>{{ $transaction['date'] }}</td>
                                <td>{{ $transaction['description'] }}</td>
                                <td>{{ $transaction['cheque_no'] ?? '—' }}</td>
                                <td class="text-end">{{ $transaction['withdrawal'] ?? '—' }}</td>
                                <td class="text-end">{{ $transaction['deposit'] ?? '—' }}</td>
                                <td class="text-end">{{ number_format($opening + $deposit - $withdrawal, 2) }}</td>
                            </tr>
                        @endif
                    @endforeach
                </tbody>
            </table>
        </div>

        <div class="pagebreak"> </div>

        @include('partials.bank_header')

        <div class="row">
            <table id="transactionTable">
                <thead>
                    <tr>
                        <th>DATE</th>
                        <th>DESCRIPTION</th>
                        <th>CHQ.NO. </th>
                        <th class="text-end">WITHDRAWAL</th>
                        <th class="text-end">DEPOSIT</th>
                        <th class="text-end">BALANCE [BDT]</th>
                    </tr>
                </thead>

                <tbody>
                    @foreach ($transactions as $key => $transaction)
                        @php
                            $deposit += $transaction['deposit'] ?? 0;
                            $withdrawal += $transaction['withdrawal'] ?? 0;
                        @endphp

                        @if ($key > 33)
                            <tr>
                                <td>{{ $transaction['date'] }}</td>
                                <td>{{ $transaction['description'] }}</td>
                                <td>{{ $transaction['cheque_no'] ?? '—' }}</td>
                                <td class="text-end">{{ $transaction['withdrawal'] ?? '—' }}</td>
                                <td class="text-end">{{ $transaction['deposit'] ?? '—' }}</td>
                                <td class="text-end">{{ number_format($opening + $deposit - $withdrawal, 2) }}</td>
                            </tr>
                        @endif
                    @endforeach
                </tbody>
            </table>
        </div>

        <hr class="ms-5 me-5">

        <div class="row fw-bold">
            <div class="col-md-4">
                Total Withdrawal in BDT:
                <br>
                Total Deposit in BDT:
            </div>
            <div class="col-md-2 text-end">
                {{ $withdrawal }}
                <br>
                {{ $deposit }}
            </div>

            <div class="col-md-4">
                Opening Balance :
                <br>
                Available Balance :
            </div>

            <div class="col-md-2 text-end">
                {{ $opening }} Cr
                <br>
                {{ number_format($opening + $deposit - $withdrawal, 2) }} Cr
            </div>
        </div>

        <p class="text-center m-3">--------------------------------------------End of
            Statement----------------------------------------------</p>

        <div class="text-end">
            <img src="{{ image_to_base64('bank-stamp.png') }}" alt="City Bank Logo"
                style="width: 30mm; height: auto; margin: 20px;">
        </div>

        <div class="pagebreak"> </div>

        <!-- SOLVENCY PAGE -->

        <section class="lh-lg" style="font-size: 1rem;">
            <div style="padding-top:50px;">
                <img src="{{ image_to_base64('city-bank-logo.png') }}" alt="City Bank Logo" style="height: 100px;">

                <p class="mt-2">
                    Sequence No.CBL/HO/RETAIL BANKING/2025/{{ rand(100000, 999999) }}
                    <br>
                    Date: 07 May, 2025
                </p>

                <div class="text-center p-5">
                    <u class="fw-bold fs-4">To whom it may concern</u>
                </div>

                <p>
                    This is to certify that, {{ $name }} having communication address {{ $address }}, has
                    been maintaining an account with City Bank
                    PLC, RAJSHAHI BRANCH bearing account no. {{ $bank_acc }} since 10 Aug, 2022. The balance
                    standing to the credit of this account as at the close of business on 30 Apr, 2025 was BDT.
                    {{ number_format($opening + $deposit - $withdrawal, 2) }}
                </p>


                <div class="row pt-3">
                    <div class="col pt-5">
                        <img src="{{ image_to_base64('bank-stamp.png') }}" alt="City Bank Logo"
                            style="width: 30mm; height: auto;">
                        <br>

                    </div>
                    <div class="col text-end">
                        <img src="{{ image_to_base64('bank-seal.png') }}" alt="City Bank Logo"
                            style="width: 50mm; height: auto;">
                        <br>
                    </div>
                </div>

                <div class="row">
                    <div class="col">
                        <u>Authorized Signatures</u>
                    </div>
                    <div class="col text-end">
                        <u>Authorized Signatures</u>
                    </div>
                </div>
            </div>
        </section>


    </div>
    </body>
    </html>